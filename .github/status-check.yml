 name: Status-aware CI/CD

 on:
   pull_request:
     branches: [ main ]

 jobs:
   build-and-comment:
     runs-on: ubuntu-latest
     steps:
       - name: Checkout repo
         uses: actions/checkout@v3

       - name: Set up JDK '21'
         uses: actions/setup-java@v3
         with:
           java-version: '21'
           distribution: 'temurin'

       - name: Build with Maven
         run: mvn clean install -DskipTests=false

       - name: Run tests
         run: mvn test

       - name: Comment on success
         if: success()
         uses: actions/github-script@v6
         with:
           script: |
             github.rest.issues.createComment({
               issue_number: context.issue.number,
               owner: context.repo.owner,
               repo: context.repo.repo,
               body: "Build and tests passed."
             })

       - name: Comment on failure
         if: failure()
         uses: actions/github-script@v6
         with:
           script: |
             github.rest.issues.createComment({
               issue_number: context.issue.number,
               owner: context.repo.owner,
               repo: context.repo.repo,
               body: "Build or tests failed. Please check logs."
             })

